rules:
  - id: python-avoid-print
    patterns:
      - pattern: print(...)
    message: "Found 'print' statement. Use a proper logger (logging.info/warning) for production applications."
    languages: [python]
    severity: WARNING
    metadata:
      category: best-practice
      technology:
        - python

  - id: fastapi-debug-true
    patterns:
      - pattern: fastapi.FastAPI(..., debug=True, ...)
    message: "FastAPI application initialized with debug=True. This is a security risk in production."
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-489"
  
  - id: py-unsafe-html-echo
    languages: [python]
    message: "Потенциально небезопасный вывод пользовательских данных в HTMLResponse"
    severity: WARNING
    patterns:
      - pattern: |
          HTMLResponse(f"...{$X}...")
    metadata:
      category: security
      cwe: "CWE-79: Cross-site Scripting"