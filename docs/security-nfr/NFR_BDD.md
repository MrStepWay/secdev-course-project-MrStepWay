# BDD-сценарии для приёмки ключевых NFR

Feature: Изоляция данных пользователей (NFR-08)

  Scenario: Пользователь не может получить доступ к чужому проекту
    Given существуют пользователи "user-A" и "user-B"
    And существует проект с ID 123, который принадлежит "user-A"
    And я аутентифицирован как "user-B"
    When я отправляю запрос GET /api/v1/projects/123
    Then я получаю ответ с кодом 404 Not Found

---

Feature: Защита от подбора пароля (NFR-04)

  Scenario: Система корректно обрабатывает несколько неверных попыток входа
    Given пользователь "user-A" существует с паролем "correct_password"
    When я отправляю 5 запросов POST /api/v1/login с неверным паролем для "user-A" с IP "228.67.13.37"
    Then я получаю 5 ответов с кодом 401 Unauthorized

  Scenario: Система блокирует IP-адрес после превышения лимита попыток входа
    Given я уже совершил 5 неудачных попыток входа с IP "228.67.13.37"
    When я отправляю 6-й запрос POST /api/v1/login с IP "228.67.13.37"
    Then я получаю ответ с кодом 429 Too Many Requests
    And тело ответа содержит информацию о времени окончания блокировки

---

Feature: Производительность API под нагрузкой (NFR-01)

  Scenario: p95 времени ответа API держится в пределах нормы
    Given сервис развернут на stage-окружении
    And запущена нагрузка в 50 RPS на эндпоинты GET /projects и GET /entries
    When выполняется 5-минутный нагрузочный тест
    Then p95 времени ответа для этих эндпоинтов не превышает 350 мс